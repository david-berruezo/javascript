<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.4/easing/EasePack.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.4/jquery.gsap.min.js"></script>
</head>
<body>
<canvas id="canvas" width="400" height="400"></canvas>
<aside>Move mouse on canvas element.</aside>
<script>
    // Object
    function Point3d (x, y, z) {
        this.x = (x === undefined) ? 0 : x;
        this.y = (y === undefined) ? 0 : y;
        this.z = (z === undefined) ? 0 : z;
        this.fl = 550;
        this.vpX = 0;
        this.vpY = 0;
        this.cX = 0;
        this.cY = 0;
        this.cZ = 0;
    }

    Point3d.prototype.setVanishingPoint = function (vpX, vpY) {
        this.vpX = vpX;
        this.vpY = vpY;
    };

    Point3d.prototype.setCenter = function (cX, cY, cZ) {
        this.cX = cX;
        this.cY = cY;
        this.cZ = cZ;
    };

    Point3d.prototype.rotateX = function (angleX) {
        y1 = this.y * Math.cos(angleX) - this.z * Math.sin(angleX),
        z1 = this.z * Math.cos(angleX) + this.y * Math.sin(angleX);
        this.y = y1;
        this.z = z1;
    };

    Point3d.prototype.rotateY = function (angleY) {
        x1 = this.x * Math.cos(angleY) - this.z * Math.sin(angleY),
        z1 = this.z * Math.cos(angleY) + this.x * Math.sin(angleY);
        this.x = x1;
        this.z = z1;
    };

    Point3d.prototype.rotateZ = function (angleZ) {
        x1 = this.x * Math.cos(angleZ) - this.y * Math.sin(angleZ),
        y1 = this.y * Math.cos(angleZ) + this.x * Math.sin(angleZ);
        this.x = x1;
        this.y = y1;
    };

    Point3d.prototype.getScreenX = function () {
        var scale = this.fl / (this.fl + this.z + this.cZ);
        return this.vpX + (this.cX + this.x) * scale;
    };

    Point3d.prototype.getScreenY = function () {
        var scale = this.fl / (this.fl + this.z + this.cZ);
        return this.vpY + (this.cY + this.y) * scale;
    };


    window.onload = function () {
        var canvas = document.getElementById('canvas'),
            context = canvas.getContext('2d'),
            //mouse = utils.captureMouse(canvas),
            points = [],
            points_dos = [],
            fl = 550,
            vpX = canvas.width / 2,
            vpY = canvas.height / 2,
            angleX, angleY,angleZ,contadorAngulos,
            contador_cuadros = 0;

        contadorAngulos = 0;

        canvas.setAttribute("width",window.innerWidth);
        canvas.setAttribute("height",window.innerHeight);
        vpX = canvas.width / 2,
        vpY = canvas.height / 2,

        // front four corners
        points[0] = new Point3d(-50,-50,-50);
        points[1] = new Point3d( 50,-50,-50);
        points[2] = new Point3d( 50,50,-50);
        points[3] = new Point3d(-50,50,-50);
        //back four corners
        points[4] = new Point3d(-50,-50,50);
        points[5] = new Point3d( 50,-50,50);
        points[6] = new Point3d( 50,50,50);
        points[7] = new Point3d(-50,50,50);

        // front four corners
        points_dos[0] = new Point3d(-50,-150,-50);
        points_dos[1] = new Point3d( 50,-150,-50);
        points_dos[2] = new Point3d( 50,-50,-50);
        points_dos[3] = new Point3d(-50,-50,-50);
        //back four corners
        points_dos[4] = new Point3d(-50,-150,50);
        points_dos[5] = new Point3d( 50,-150,50);
        points_dos[6] = new Point3d( 50,-50,50);
        points_dos[7] = new Point3d(-50,-50,50);

        points.forEach(function (point) {
            point.setVanishingPoint(vpX, vpY);
        });

        points_dos.forEach(function (point) {
            point.setVanishingPoint(vpX, vpY);
        });

        function move (point) {
            point.rotateX(angleX);
            point.rotateY(angleY);
            point.rotateZ(angleZ);
        }

        function crearPuntos(points,radius){
            for (i=0;i<points.length;i++){
                context.beginPath();
                context.arc(points[i].getScreenX(),points[i].getScreenY(),radius,0,2*Math.PI);
                context.fill();
                context.stroke();
            }
        }


        (function drawFrame () {
            window.requestAnimationFrame(drawFrame, canvas);
            context.clearRect(0, 0, canvas.width, canvas.height);
            var valor = 2 * Math.PI;
            if (contadorAngulos < valor){
                angleX = 0;
                angleZ = 0;
                angleY = 0.01;
                contadorAngulos = contadorAngulos + angleY;
            }else{
                angleX = 0;
                angleY = 0;
                angleZ = 0;
            }
            points.forEach(move);
            crearPuntos(points,15);
            points_dos.forEach(move);
            crearPuntos(points_dos,5);
            console.log("punto 0 x: "+points[0].getScreenX()+" punto 0 y: "+points[0].getScreenY());
        }());
    };
</script>
</body>
</html>