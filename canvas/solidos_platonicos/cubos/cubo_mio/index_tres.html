<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<canvas id="canvas" width="400" height="400"></canvas>
<aside>Move mouse on canvas element.</aside>
<script>
    // Object
    function Point3d (x, y, z) {
        this.x = (x === undefined) ? 0 : x;
        this.y = (y === undefined) ? 0 : y;
        this.z = (z === undefined) ? 0 : z;
        this.fl = 550;
        this.vpX = 0;
        this.vpY = 0;
        this.cX = 0;
        this.cY = 0;
        this.cZ = 0;
    }

    Point3d.prototype.setVanishingPoint = function (vpX, vpY) {
        this.vpX = vpX;
        this.vpY = vpY;
    };

    Point3d.prototype.setCenter = function (cX, cY, cZ) {
        this.cX = cX;
        this.cY = cY;
        this.cZ = cZ;
    };


    Point3d.prototype.rotateX = function (angleX) {
        y1 = this.y * Math.cos(angleX) - this.z * Math.sin(angleX),
        z1 = this.z * Math.cos(angleX) + this.y * Math.sin(angleX);
        this.y = y1;
        this.z = z1;
    };

    Point3d.prototype.rotate = function (angleX,angleY,angleZ) {
        // Math.sin(a+b+c) = Math.sin(a) * Math.cos(b) * Math.cos(c) + Math.cos(b) * Math.sin(a) + Math.cos(c) + Math.sin(a) * Math.sin(b) * Math.sin(c) + Math.cos(a) * Math.cos(B) * Math.cos(c)
        /*
        // Math.sin(a+b) = Math.sin(a)* Math.cos(b) + Math.sin(b) * Math.cos(a)
        // Math.cos(a+b) = Math.cos(a) * Math.cos(b) - Math.sin(a) * Math.sin(b)
        y3 = center_y + radius * (Math.sin(vector_objects[i].angle * (Math.PI/180)) * Math.cos(1 * (Math.PI/180)) + Math.sin(1 * (Math.PI/180)) * Math.cos(vector_objects[i].angle * (Math.PI/180)));
        x3 = center_x + radius * (Math.cos(vector_objects[i].angle * (Math.PI/180)) * Math.cos(1 * (Math.PI/180)) - Math.sin(vector_objects[i].angle * (Math.PI/180)) * Math.sin(1 * (Math.PI/180)));
        */
    };

    Point3d.prototype.rotateY = function (angleY) {
        x1 = this.x * Math.cos(angleY) - this.z * Math.sin(angleY),
        z1 = this.z * Math.cos(angleY) + this.x * Math.sin(angleY);
        this.x = x1;
        this.z = z1;
    };

    Point3d.prototype.rotateZ = function (angleZ) {
        x1 = this.x * Math.cos(angleZ) - this.y * Math.sin(angleZ),
        y1 = this.y * Math.cos(angleZ) + this.x * Math.sin(angleZ);
        this.x = x1;
        this.y = y1;
    };

    Point3d.prototype.getScreenX = function () {
        var scale = this.fl / (this.fl + this.z + this.cZ);
        return this.vpX + (this.cX + this.x) * scale;
    };

    Point3d.prototype.getScreenY = function () {
        var scale = this.fl / (this.fl + this.z + this.cZ);
        return this.vpY + (this.cY + this.y) * scale;
    };


    window.onload = function () {
        var canvas = document.getElementById('canvas'),
            context = canvas.getContext('2d'),
            //mouse = utils.captureMouse(canvas),
            points = [],
            fl = 550,
            vpX = canvas.width / 2,
            vpY = canvas.height / 2,
            angleX, angleY,angleZ,contadorAngulos,
            contador_cuadros = 0,
            lines = [];

        contadorAngulos = 0;

        canvas.setAttribute("width",window.innerWidth);
        canvas.setAttribute("height",window.innerHeight);
        vpX = canvas.width / 2;
        vpY = canvas.height / 2;

        // points
        for(var i = 0; i <= 2; i++)
        {
            for(var j = 0; j <= 2; j++)
            {
                for(var k = 0; k <= 2; k++)
                {
                    var x = 200 * (i / 2 - .5),
                        y = 200 * (j / 2 - .5),
                        z = 200 * (k / 2 - .5);
                    points[contador_cuadros] = new Point3d(x, y, z);
                    //console.log("Contadores k: "+k+" j: "+j+" i:"+i);
                    contador_cuadros++;
                }
            }
        }

        // lines
        var l = 3,
        l2 = l * l;
        for(var i = 0; i < l; i++)
        {
            for(var j = 0; j < l; j++)
            {
                for(var k = 0; k < l; k++)
                {
                    var id = i * l2 + j * l + k;
                    if(i > 0){
                        lines.push([id, id - l2]);
                    }
                    if(j > 0){
                        lines.push([id, id - l]);
                    }

                    if(k > 0){
                        lines.push([id, id - 1]);
                    }
                }
            }
        }

        points.forEach(function (point) {
            point.setVanishingPoint(vpX, vpY);
        });


        function move (point) {
            /*
            point.rotateX(angleX);
            point.rotateY(angleY);
            point.rotateZ(angleZ);
            */
            point.rotateY(angleY);
        }

        function crearPuntos(points){
            for (i=0;i<points.length;i++){
                context.beginPath();
                context.arc(points[i].getScreenX(),points[i].getScreenY(),3,0,2*Math.PI);
                context.fill();
                context.stroke();
            }
        }

        function crear_linias_puntos(points){
            context.beginPath();
            for(i = 0, l = lines.length; i < l; i++)
            {
                context.moveTo(points[lines[i][0]].getScreenX(), points[lines[i][0]].getScreenY());
                context.lineTo(points[lines[i][1]].getScreenX(), points[lines[i][1]].getScreenY());
            }
            context.stroke();
        }


        (function drawFrame () {
            window.requestAnimationFrame(drawFrame, canvas);
            context.clearRect(0, 0, canvas.width, canvas.height);
            var valor = 1000* Math.PI;
            if (contadorAngulos < valor){
                angleX = 0;
                angleZ = 0;
                angleY = 0.01;
                contadorAngulos = contadorAngulos + angleY;
            }else{
                angleX = 0;
                angleY = 0;
                angleZ = 0;
            }
            points.forEach(move);
            crearPuntos(points);
            crear_linias_puntos(points);
        }());
    };
</script>
</body>
</html>