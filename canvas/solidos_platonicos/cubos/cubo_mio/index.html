<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    // Object
    function Point3d (x, y, z) {
        this.x = (x === undefined) ? 0 : x;
        this.y = (y === undefined) ? 0 : y;
        this.z = (z === undefined) ? 0 : z;
        this.fl = 250;
        this.vpX = 0;
        this.vpY = 0;
        this.cX = 0;
        this.cY = 0;
        this.cZ = 0;
    }

    Point3d.prototype.setVanishingPoint = function (vpX, vpY) {
        this.vpX = vpX;
        this.vpY = vpY;
    };

    Point3d.prototype.setCenter = function (cX, cY, cZ) {
        this.cX = cX;
        this.cY = cY;
        this.cZ = cZ;
    };

    Point3d.prototype.rotateX = function (angleX) {
        y1 = this.y * Math.cos(angleX) - this.z * Math.sin(angleX),
        z1 = this.z * Math.cos(angleX) + this.y * Math.sin(angleX);
        this.y = y1;
        this.z = z1;
    };

    Point3d.prototype.rotateY = function (angleY) {
        x1 = this.x * Math.cos(angleY) - this.z * Math.sin(angleY),
        z1 = this.z * Math.cos(angleY) + this.x * Math.sin(angleY);
        this.x = x1;
        this.z = z1;
    };

    Point3d.prototype.rotateZ = function (angleZ) {
        x1 = this.x * Math.cos(angleZ) - this.y * Math.sin(angleZ),
        y1 = this.y * Math.cos(angleZ) + this.x * Math.sin(angleZ);
        this.x = x1;
        this.y = y1;
    };

    Point3d.prototype.getScreenX = function () {
        var scale = this.fl / (this.fl + this.z + this.cZ);
        return this.vpX + (this.cX + this.x) * scale;
    };

    Point3d.prototype.getScreenY = function () {
        var scale = this.fl / (this.fl + this.z + this.cZ);
        return this.vpY + (this.cY + this.y) * scale;
    };


    window.onload = function () {
        var canvas = document.getElementById('canvas'),
            context = canvas.getContext('2d'),
            //mouse = utils.captureMouse(canvas),
            points = [],
            fl = 250,
            vpX = canvas.width / 2,
            vpY = canvas.height / 2,
            angleX, angleY,angleZ,contadorAngulos,
            contador_cuadros = 0;

        contadorAngulos = 0;

        //front four corners
        points[0] = new Point3d(-100, -100, -100);
        points[1] = new Point3d( 100, -100, -100);
        points[2] = new Point3d( 100, 100, -100);
        points[3] = new Point3d(-100, 100, -100);
        //back four corners
        points[4] = new Point3d(-100, -100, 100);
        points[5] = new Point3d( 100, -100, 100);
        points[6] = new Point3d( 100,100,100);
        points[7] = new Point3d( -100,100,100);

        points.forEach(function (point) {
            point.setVanishingPoint(vpX, vpY);
        });


        function move (point) {
            point.rotateX(angleX);
            point.rotateY(angleY);
            point.rotateZ(angleZ);
        }


        function crearLinias(){
            context.save();
            // Primer cuadro
            // 1 a la 0
            context.beginPath();
            context.moveTo(points[0].getScreenX(),points[0].getScreenY());
            context.lineTo(points[1].getScreenX(),points[1].getScreenY());
            context.stroke();
            // 1 a la 2
            context.beginPath();
            context.moveTo(points[2].getScreenX(),points[2].getScreenY());
            context.lineTo(points[1].getScreenX(),points[1].getScreenY());
            context.stroke();
            // B a la C
            context.beginPath();
            context.moveTo(points[2].getScreenX(),points[2].getScreenY());
            context.lineTo(points[3].getScreenX(),points[3].getScreenY());
            context.stroke();
            // B a la A
            context.beginPath();
            context.moveTo(points[0].getScreenX(),points[0].getScreenY());
            context.lineTo(points[3].getScreenX(),points[3].getScreenY());
            context.stroke();

            // Segundo cuadro
            // C a la D
            context.beginPath();
            context.moveTo(points[5].getScreenX(),points[5].getScreenY());
            context.lineTo(points[4].getScreenX(),points[4].getScreenY());
            context.stroke();

            context.beginPath();
            context.moveTo(points[6].getScreenX(),points[6].getScreenY());
            context.lineTo(points[5].getScreenX(),points[5].getScreenY());
            context.stroke();

            context.beginPath();
            context.moveTo(points[7].getScreenX(),points[7].getScreenY());
            context.lineTo(points[6].getScreenX(),points[6].getScreenY());
            context.stroke();

            context.beginPath();
            context.moveTo(points[7].getScreenX(),points[7].getScreenY());
            context.lineTo(points[4].getScreenX(),points[4].getScreenY());
            context.stroke();

            // Diagonales
            context.beginPath();
            context.moveTo(points[4].getScreenX(),points[4].getScreenY());
            context.lineTo(points[0].getScreenX(),points[0].getScreenY());
            context.stroke();

            context.beginPath();
            context.moveTo(points[7].getScreenX(),points[7].getScreenY());
            context.lineTo(points[3].getScreenX(),points[3].getScreenY());
            context.stroke();

            context.beginPath();
            context.moveTo(points[2].getScreenX(),points[2].getScreenY());
            context.lineTo(points[6].getScreenX(),points[6].getScreenY());
            context.stroke();

            context.beginPath();
            context.moveTo(points[1].getScreenX(),points[1].getScreenY());
            context.lineTo(points[5].getScreenX(),points[5].getScreenY());
            context.stroke();

            // Cuadro superior
            context.globalAlpha = 1;
            context.fillStyle = '#cccccc';
            context.beginPath();
            context.moveTo(points[0].getScreenX(),points[0].getScreenY());
            context.lineTo(points[1].getScreenX(),points[1].getScreenY());
            context.lineTo(points[5].getScreenX(),points[5].getScreenY());
            context.lineTo(points[4].getScreenX(),points[4].getScreenY());
            context.closePath();
            context.fill();

            // Cuadro inferior
            context.globalAlpha = 1;
            context.fillStyle = '#cccccc';
            context.beginPath();
            context.moveTo(points[3].getScreenX(),points[3].getScreenY());
            context.lineTo(points[7].getScreenX(),points[7].getScreenY());
            context.lineTo(points[6].getScreenX(),points[6].getScreenY());
            context.lineTo(points[2].getScreenX(),points[2].getScreenY());
            context.closePath();
            context.fill();

            // Cuadro lateral izquierdo
            context.globalAlpha = 1;
            context.fillStyle = '#333333';
            context.beginPath();
            context.moveTo(points[4].getScreenX(),points[4].getScreenY());
            context.lineTo(points[0].getScreenX(),points[0].getScreenY());
            context.lineTo(points[3].getScreenX(),points[3].getScreenY());
            context.lineTo(points[7].getScreenX(),points[7].getScreenY());
            context.closePath();
            context.fill();

            // Cuadro lateral derecho
            context.globalAlpha = 1;
            context.fillStyle = '#333333';
            context.beginPath();
            context.moveTo(points[5].getScreenX(),points[5].getScreenY());
            context.lineTo(points[6].getScreenX(),points[6].getScreenY());
            context.lineTo(points[1].getScreenX(),points[1].getScreenY());
            context.lineTo(points[2].getScreenX(),points[2].getScreenY());
            context.closePath();
            context.fill();
        }


        (function drawFrame () {
            window.requestAnimationFrame(drawFrame, canvas);
            context.clearRect(0, 0, canvas.width, canvas.height);
            var valor = Math.PI;
            if (contadorAngulos < valor){
                angleX = 0;
                angleZ = 0;
                angleY = 0.01;
                contadorAngulos = contadorAngulos + angleY;
            }else{
                angleX = 0;
                angleY = 0;
                angleZ = 0;
            }
            points.forEach(move);
            crearLinias();
            console.log("punto 0 x: "+points[0].getScreenX()+" punto 0 y: "+points[0].getScreenY());
        }());
    };
</script>
<canvas id="canvas" width="500" height="500">
    Your browser does not support HTML5 canvas.
</canvas>
</body>
</html>